<vc>
    <formgroup id="f2b_v"/>
    <servicebar name="fail2ban"/>
    <body>
        <tabs>
            <tab title="{Configure}">
                <pad>
                    <bind:collection bind="configurations">
                        <tabs bind="__items"/>
                        <bind:template>
                            <tab bind="name">
                                <box height="700" scroll="True">
                                    <vc>
                                        <hc>
                                            <icon icon="folder-open"/>
                                            <label bind="path"/>
                                        </hc>
                                        <bind:collection bind="configlist" id="configlist">
                                            <dt bind="__items" addrow="{Add}"/>

                                            <bind:template>
                                                <collapserow>
                                                    <box>
                                                        <right>
                                                            <hc>
                                                                <label bind="configfile"/>
                                                                <box width="5"/>
                                                                <button bind="__delete" icon="remove" style="icon"
                                                                        warning="{Confirm deletion}"/>
                                                            </hc>
                                                        </right>
                                                        <hc>
                                                            <icon icon="list-alt"/>
                                                            <label bind="name"/>
                                                        </hc>
                                                    </box>
                                                    <pad>
                                                        <codearea height="480" width="720" bind="config"/>
                                                    </pad>
                                                </collapserow>
                                            </bind:template>
                                        </bind:collection>
                                    </vc>
                                </box>
                            </tab>
                        </bind:template>
                    </bind:collection>
                </pad>
                <hc>
                    <button id="save-button" text="{Save}" icon="ok"/>
                </hc>
            </tab>
            <tab title="{Filters checker}">
                <formgroup text="{Check regex}"/>
                <hc>
                    <label text="{Filter file}" style="bold"/>
                    <textbox id="filter-filename"/>
                    <button id="open-filter-button" text="{Open}" icon="folder-open"/>
                    <button id="save-filter-button" text="{Save}" icon="folder-open"/>
                </hc>
                <pad>
                    <codearea id="filter-file" height="150" width="700"/>
                </pad>
                <hc>
                    <label text="{Log file}" style="bold"/>
                    <textbox id="log-filename"/>
                    <button id="open-log-button" text="{Open}" icon="folder-open"/>
                </hc>
                <pad>
                    <codearea id="log-file" height="150" width="700"/>
                </pad>
                <button id="check-regex" text="{Run test}" icon="play"/>
                <label id="check-status" style="bold"/>
            </tab>
        </tabs>
    </body>
    <openfiledialog id="openfilterdialog" visible="False" path="/etc/fail2ban/filter.d/"/>
    <openfiledialog id="openlogdialog" visible="False" path="/var/log"/>
</vc>
